resources:
  accelerators: [RTXA4000:1, T4:1, RTXA6000:1, L4:1, V100:1]
  ports: 5000
  image_id: docker:yasomimi/sdxl-tigris:latest
  # any_of:
  #   - cloud: runpod
  #     accelerators: A4000:1
  #   - cloud: aws
  #     region: us-east-2
  #     accelerators: T4:1

service:
  readiness_probe:
    path: /
    initial_delay_seconds: 5
  replica_policy:
    min_replicas: 1
    max_replicas: 3
    target_qps_per_replica: 0.5
    upscale_delay_seconds: 5
    downscale_delay_seconds: 90

run: |
  cd /src
  /root/.pyenv/shims/python -m cog.server.http

envs:
  # Tigris config
  AWS_ACCESS_KEY_ID: tid_AzureDiamond # workload access key ID
  AWS_SECRET_ACCESS_KEY: tsec_hunter2 # workload secret access key
  AWS_ENDPOINT_URL_S3: https://fly.storage.tigris.dev
  AWS_REGION: auto

  # Bucket names
  MODEL_BUCKET_NAME: model-storage
  PUBLIC_BUCKET_NAME: generated-images

  # Model to load
  MODEL_PATH: ByteDance/SDXL-Lightning